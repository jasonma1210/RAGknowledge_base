spring:
  application:
    name: rag-knowledge-base
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB
  datasource:
    master:
      jdbc-url: jdbc:mysql://localhost:3306/rag_knowledge_base?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
      username: root
      password: 12345678
      driver-class-name: com.mysql.cj.jdbc.Driver
      hikari:
        maximum-pool-size: 20
        minimum-idle: 5
        connection-timeout: 30000
        idle-timeout: 600000
        max-lifetime: 1800000
        leak-detection-threshold: 60000
    slave:
      jdbc-url: jdbc:mysql://localhost:3306/rag_knowledge_base?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
      username: root
      password: 12345678
      driver-class-name: com.mysql.cj.jdbc.Driver
      hikari:
        maximum-pool-size: 20
        minimum-idle: 5
        connection-timeout: 30000
        idle-timeout: 600000
        max-lifetime: 1800000
        leak-detection-threshold: 60000
  data:
    redis:
      host: localhost
      port: 6379
      database: 0
      password:
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-wait: -1ms
          max-idle: 8
          min-idle: 0
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.MySQL8Dialect
server:
  port: 8080

milvus:
  host: localhost
  port: 19530
  collection:
    name: knowledge_base
    dimension: 1024

langchain4j:
  community:
    dashscope:
      chat-model:
        model-name: qwen-max-latest
        temperature: 0.7
        max-tokens: 2000
        api-key: sk-04408f09a97047f59418251783cd7d7f
      streaming-chat-model:
        model-name: qwen-max-latest
        temperature: 0.7
        max-tokens: 2000
        api-key: sk-04408f09a97047f59418251783cd7d7f
      embedding-model:
        model-name: text-embedding-v4
        api-key: sk-04408f09a97047f59418251783cd7d7f

document:
  chunk:
    size: 1000
    overlap: 200
  supported-formats: pdf,docx,txt,md,epub

retrieval:
  top-k: 10
  score-threshold: 0.7

logging:
  level:
    com.aliyun.rag: DEBUG
    dev.langchain4j: INFO

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus,env,configprops
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      show-components: always
    metrics:
      enabled: true
    prometheus:
      enabled: true
  prometheus:
    metrics:
      export:
        enabled: true
        step: 60s
  metrics:
    distribution:
      percentiles-histogram:
        http.server.requests: true
        method.timed: true
      percentiles:
        http.server.requests: 0.5,0.75,0.95,0.99
      sla:
        http.server.requests: 100ms,200ms,500ms,1s,2s

# 七牛云配置
qiniu:
  access-key: 123
  secret-key: 321
  bucket: 3333
  domain: http://file.3333333.cn



# JWT配置
jwt:
  secret: ${JWT_SECRET:RAGKnowledgeBaseDefaultSecretKeyForJWTTokenGenerationAndValidation2025}
  expiration: 7200000  # 2小时
  refresh-expiration: 604800000  # 7天
  token-prefix: "Bearer "
  header-name: "Authorization"
  issuer: "RAG-Knowledge-Base"

# CORS跨域配置
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:8080,http://localhost:5175}
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: "*"
  allow-credentials: true
  max-age: 3600

# 异步线程池配置
async:
  thread-pool:
    # 文件处理线程池
    file-process:
      core-pool-size: 5
      max-pool-size: 20
      queue-capacity: 100
      thread-name-prefix: "FileProcess-"
      keep-alive-seconds: 300
    # 文档解析线程池
    document-parse:
      core-pool-size: 3
      max-pool-size: 10
      queue-capacity: 50
      thread-name-prefix: "DocParse-"
      keep-alive-seconds: 300
    # 向量处理线程池
    vector-process:
      core-pool-size: 2
      max-pool-size: 8
      queue-capacity: 30
      thread-name-prefix: "VectorProcess-"
      keep-alive-seconds: 600
    # 通用异步任务线程池
    async-task:
      core-pool-size: 2
      max-pool-size: 5
      queue-capacity: 20
      thread-name-prefix: "AsyncTask-"
      keep-alive-seconds: 60
    # Trace处理线程池
    trace-process:
      core-pool-size: 4
      max-pool-size: 14
      queue-capacity: 100
      thread-name-prefix: "TraceProcess-"
      keep-alive-seconds: 600